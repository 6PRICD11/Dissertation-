local addresses = {
    { address = "2.18.27.76", longitude = -0.6718, latitude = 51.5368 },
    { address = "2.18.27.82", longitude = -0.6718, latitude = 51.5368 },
    { address = "2.18.27.89", longitude = -0.6718, latitude = 51.5368 },
    { address = "2.19.252.151", longitude = -0.6718, latitude = 51.5368 },
    { address = "3.75.168.79", longitude = 8.6837, latitude = 50.1169 },
    { address = "8.8.8.8", longitude = -97.822, latitude = 37.751 },
    { address = "20.90.152.133", longitude = -0.1278, latitude = 51.5081 },
    { address = "42.194.136.76", longitude = 113.2539, latitude = 23.1181 },
    { address = "52.105.34.25", longitude = -6.2591, latitude = 53.3382 },
    { address = "92.123.128.166", longitude = -0.1278, latitude = 51.5081 },
    { address = "142.250.178.3", longitude = -97.822, latitude = 37.751 },
    { address = "142.250.179.238", longitude = -97.822, latitude = 37.751 },
    { address = "204.79.197.203", longitude = -97.822, latitude = 37.751 },
    { address = "216.58.204.74", longitude = -97.822, latitude = 37.751 },
    { address = "54.239.26.23", longitude = -77.0369, latitude = 38.9072 },
    { address = "104.26.10.172", longitude = -122.3321, latitude = 47.6062 },
    { address = "151.101.1.69", longitude = -74.006, latitude = 40.7128 },
    { address = "185.199.108.153", longitude = 2.3522, latitude = 48.8566 },
    { address = "202.160.128.111", longitude = 103.8198, latitude = 1.3521 },
    { address = "203.0.113.45", longitude = 144.9631, latitude = -37.8136 },
    { address = "209.85.231.100", longitude = -118.2437, latitude = 34.0522 },
    { address = "45.33.32.156", longitude = -80.1918, latitude = 25.7617 },
    { address = "129.250.35.250", longitude = 139.6917, latitude = 35.6895 },
    { address = "217.160.86.6", longitude = 13.405, latitude = 52.52 },
    { address = "103.21.244.0", longitude = 72.8777, latitude = 19.076 },
    { address = "31.13.79.246", longitude = -58.3816, latitude = -34.6037 },
    { address = "81.2.69.160", longitude = 14.4208, latitude = 50.088 },
    { address = "46.101.160.123", longitude = 4.9041, latitude = 52.3676 },
    { address = "58.97.5.29", longitude = 100.5018, latitude = 13.7563 },
    { address = "119.28.48.228", longitude = 114.1694, latitude = 22.3193 },
    { address = "45.132.20.101", longitude = 28.9784, latitude = 41.0082 },
    { address = "67.225.192.12", longitude = -123.1216, latitude = 49.2827 },
    { address = "185.60.216.35", longitude = 30.5234, latitude = 50.4501 },
    { address = "190.92.55.89", longitude = -74.0721, latitude = 4.711 },
    { address = "138.199.68.19", longitude = -47.8825, latitude = -15.7942 },
    { address = "195.162.25.43", longitude = 135.7681, latitude = 35.0116 },
    { address = "202.134.25.88", longitude = 139.6503, latitude = 35.6762 },
    { address = "180.76.15.162", longitude = 116.4074, latitude = 39.9042 },
    { address = "74.125.24.102", longitude = 12.4964, latitude = 41.9028 },
    { address = "66.220.149.50", longitude = -79.3832, latitude = 43.6532 },
    { address = "220.233.24.56", longitude = 153.0251, latitude = -27.4698 },
    { address = "23.227.38.32", longitude = -43.1729, latitude = -22.9068 },
    { address = "213.186.33.19", longitude = 6.9603, latitude = 50.9375 },
    { address = "50.87.253.48", longitude = 151.2093, latitude = -33.8688 },
    { address = "93.184.220.29", longitude = -3.1883, latitude = 55.9533 },
    { address = "160.153.129.19", longitude = -4.2518, latitude = 55.8642 },
    { address = "178.62.200.250", longitude = -0.1226, latitude = 51.5074 },
    { address = "192.99.100.23", longitude = -73.5673, latitude = 45.5017 },
    { address = "185.199.111.153", longitude = 5.2913, latitude = 52.1326 },
    { address = "45.33.32.100", longitude = -115.1467, latitude = 36.1699 },
    { address = "67.199.248.12", longitude = -90.0715, latitude = 29.9511 },
    { address = "23.105.135.77", longitude = -157.8583, latitude = 21.3069 },
    { address = "144.76.189.100", longitude = 11.581, latitude = 48.1351 },
    { address = "82.165.33.21", longitude = 37.6173, latitude = 55.7558 },
    { address = "168.78.36.27", longitude = 95.6543, latitude = -24.3210 },
    { address = "190.54.33.15", longitude = -96.9876, latitude = 51.4321 },
    { address = "230.34.59.82", longitude = 126.5432, latitude = -33.6543 },
    { address = "155.76.57.35", longitude = -41.3210, latitude = 13.8765 },
    { address = "120.44.68.97", longitude = 79.4321, latitude = -39.5432 },
    { address = "199.168.22.14", longitude = -115.6543, latitude = 44.3210 },
    { address = "78.78.93.102", longitude = 3.8765, latitude = -10.5432 },
    { address = "90.23.47.51", longitude = -76.3210, latitude = 30.8765 },
    { address = "216.55.31.21", longitude = 138.7654, latitude = -50.4321 },
    { address = "42.67.83.98", longitude = -66.9876, latitude = 19.2109 },
    { address = "170.78.37.29", longitude = 97.3210, latitude = -26.5432 },
    { address = "200.54.35.17", longitude = -94.5432, latitude = 49.9876 },
    { address = "240.34.60.85", longitude = 124.7654, latitude = -34.2109 },
    { address = "160.76.58.40", longitude = -39.9876, latitude = 12.6543 },
    { address = "130.44.69.95", longitude = 81.2109, latitude = -40.4321 },
    { address = "202.168.20.12", longitude = -112.5432, latitude = 46.9876 },
    { address = "79.78.94.105", longitude = 2.4321, latitude = -12.7654 },
    { address = "92.23.48.49", longitude = -78.2109, latitude = 32.5432 },
    { address = "218.55.32.25", longitude = 140.8765, latitude = -51.6543 },
    { address = "44.67.82.95", longitude = -68.5432, latitude = 20.9876 },
    { address = "175.78.38.31", longitude = 99.2109, latitude = -27.8765 },
    { address = "205.54.36.19", longitude = -93.4321, latitude = 48.7654 },
    { address = "250.34.61.88", longitude = 122.9876, latitude = -35.4321 },
    { address = "103.45.67.89", longitude = 72.3456, latitude = -35.6789 },
    { address = "192.168.34.21", longitude = -123.4567, latitude = 48.1234 },
    { address = "56.78.90.123", longitude = 15.9876, latitude = -12.3456 },
    { address = "89.23.45.67", longitude = -87.6543, latitude = 23.4567 },
    { address = "210.55.33.12", longitude = 134.7654, latitude = -45.6789 },
    { address = "45.67.89.101", longitude = -60.1234, latitude = 10.5678 },
    { address = "156.78.34.22", longitude = 89.4567, latitude = -25.6789 },
    { address = "176.54.32.11", longitude = -99.8765, latitude = 55.4321 },
    { address = "201.34.56.78", longitude = 120.2345, latitude = -30.5678 },
    { address = "134.76.54.32", longitude = -45.6789, latitude = 12.3456 },
    { address = "102.45.67.98", longitude = 50.2341, latitude = -20.7894 },
    { address = "195.168.24.19", longitude = -110.5678, latitude = 40.6789 },
    { address = "66.78.91.120", longitude = 10.8765, latitude = -5.4321 },
    { address = "99.23.42.56", longitude = -80.9876, latitude = 27.6543 },
    { address = "211.55.32.15", longitude = 140.4321, latitude = -47.8765 },
    { address = "38.67.88.100", longitude = -62.4321, latitude = 15.6789 },
    { address = "162.78.30.25", longitude = 100.5678, latitude = -22.1234 },
    { address = "180.54.31.10", longitude = -92.8765, latitude = 53.2109 },
    { address = "220.34.57.79", longitude = 128.4321, latitude = -31.5432 },
    { address = "144.76.55.30", longitude = -43.7654, latitude = 14.9876 },
    { address = "111.44.67.99", longitude = 77.6543, latitude = -38.2109 },
    { address = "198.168.24.16", longitude = -118.4321, latitude = 42.6789 },
    { address = "77.78.92.100", longitude = 5.9876, latitude = -8.6543 },
    { address = "88.23.46.54", longitude = -72.5432, latitude = 29.8765 },
    { address = "215.55.30.19", longitude = 136.3210, latitude = -49.7654 },
    { address = "41.67.85.99", longitude = -64.2109, latitude = 18.4321 },
    { address = "168.78.36.27", longitude = 95.6543, latitude = -24.3210 },
    { address = "190.54.33.15", longitude = -96.9876, latitude = 51.4321 },
    { address = "230.34.59.82", longitude = 126.5432, latitude = -33.6543 },
    { address = "155.76.57.35", longitude = -41.3210, latitude = 13.8765 },
    { address = "120.44.68.97", longitude = 79.4321, latitude = -39.5432 },
    { address = "199.168.22.14", longitude = -115.6543, latitude = 44.3210 },
    { address = "78.78.93.102", longitude = 3.8765, latitude = -10.5432 },
    { address = "90.23.47.51", longitude = -76.3210, latitude = 30.8765 },
    { address = "216.55.31.21", longitude = 138.7654, latitude = -50.4321 },
    { address = "42.67.83.98", longitude = -66.9876, latitude = 19.2109 },
    { address = "170.78.37.29", longitude = 97.3210, latitude = -26.5432 },
    { address = "200.54.35.17", longitude = -94.5432, latitude = 49.9876 },
    { address = "240.34.60.85", longitude = 124.7654, latitude = -34.2109 },
    { address = "160.76.58.40", longitude = -39.9876, latitude = 12.6543 },
    { address = "130.44.69.95", longitude = 81.2109, latitude = -40.4321 },
    { address = "202.168.20.12", longitude = -112.5432, latitude = 46.9876 },
    { address = "79.78.94.105", longitude = 2.4321, latitude = -12.7654 },
    { address = "92.23.48.49", longitude = -78.2109, latitude = 32.5432 },
    { address = "218.55.32.25", longitude = 140.8765, latitude = -51.6543 },
    { address = "44.67.82.95", longitude = -68.5432, latitude = 20.9876 },
    { address = "175.78.38.31", longitude = 99.2109, latitude = -27.8765 },
    { address = "205.54.36.19", longitude = -93.4321, latitude = 48.7654 },
    { address = "250.34.61.88", longitude = 122.9876, latitude = -35.4321 }
}


local html_template = [[
<!DOCTYPE html>
<html>
<head>
    <title>Google Maps Plot</title>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCL20d4eLO1fFvfqkpz4l1WDYhqMM9pRF8"></script>
    <script>
        function initMap() {
            var map = new google.maps.Map(document.getElementById("map"), {
                zoom: 3,
                center: { lat: 20, lng: 0 } // Centered globally
            });

            var locations = %s; // Insert JSON data from Lua

            locations.forEach(function(location) {
                var marker = new google.maps.Marker({
                    position: { lat: location.latitude, lng: location.longitude },
                    map: map,
                    title: location.address // IP address as marker title
                });

                var infoWindow = new google.maps.InfoWindow({
                    content: "<b>IP Address:</b> " + location.address
                });

                marker.addListener("click", function() {
                    infoWindow.open(map, marker);
                });
            });
        }
    </script>
</head>
<body onload="initMap()">
    <div id="map" style="width: 100%%; height: 600px;"></div>
</body>
</html>
]]

-- Convert Lua table to JavaScript array format
local function to_json(tbl)
    local items = {}
    for _, entry in ipairs(tbl) do
        table.insert(items, string.format(
            '{ address: "%s", latitude: %f, longitude: %f }',
            entry.address, entry.latitude, entry.longitude
        ))
    end
    return "[" .. table.concat(items, ", ") .. "]"
end

-- Write HTML file
local file = io.open("Googlemap.html", "w")
file:write(html_template:format(to_json(addresses)))
file:close()

print("HTML file 'Googlemap.html' created. Open it in a browser to view the map.")
